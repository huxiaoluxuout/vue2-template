function e(){console.log("默认回调函数")}function i(e){uni.showModal({title:"权限提示",content:"定位服务未开启",confirmText:"去设置",success:i=>{i.confirm&&uni.openAppAuthorizeSetting({success(i){e()}}),i.cancel&&e()}})}let o="";const{checkGPS:n,showAuthTipModal:s}=Promise.resolve().then((function(){return d}));uni.getSystemInfo({success(e){o=e.uniPlatform}});const r=async({count:i=3,sizeType:n=["original","compressed"],sourceType:r=["album","camera"],success:t=e,fail:a=e,complete:c=e,...d})=>{let l=r.includes("album"),u=r.includes("camera"),A=!0;return"app"===o&&(l&&u?A=await s("READ_EXTERNAL_STORAGE_CAMERA"):u?A=await s("CAMERA"):l&&(A=await s("READ_EXTERNAL_STORAGE"))),new Promise(((e,o)=>{A&&uni.chooseImage({count:i,sizeType:n,sourceType:r,...d,success(i){e(i),t(i)},fail(e){console.error("chooseImage",e),a(e),o(e)},complete(e){c(e)}})}))},t=e=>{let i=[e];return Array.isArray(e)&&(i=e),new Promise((e=>{plus.android.requestPermissions(i,(function(i){i.deniedAlways.length?e(0):i.deniedPresent.length?e(1):i.granted.length&&e(2)}))}))},a=(e,i)=>{t(e).then((o=>{2===o||1===o?i(!0):0===o&&(c(e),i(!1))}))},c=e=>{const i={"android.permission.ACCESS_FINE_LOCATION":"获取定位权限失败，请手动打开授权或检查系统定位开关","android.permission.CALL_PHONE":"获取拨打电话权限失败，请手动打开授权","android.permission.READ_EXTERNAL_STORAGE":"获取相册权限失败，请手动打开授权","android.permission.CAMERA":"获取相机权限失败，请手动打开授权",[["android.permission.READ_EXTERNAL_STORAGE","android.permission.CAMERA"]]:"获取相机或相册权限失败，请手动打开授权"};uni.showModal({title:"权限提示",content:i[e],confirmText:"去设置",success:e=>{e.confirm&&uni.openAppAuthorizeSetting({success(e){console.log(e)}}),e.cancel}})};var d=Object.freeze({__proto__:null,authorizeReject:c,checkGPS:()=>new Promise(((e,o)=>{var n,s,r,t,a,c=plus.os.name;"android"===c.toLowerCase()?(n=plus.android.importClass("android.content.Context"),s=plus.android.importClass("android.location.LocationManager"),(r=plus.android.runtimeMainActivity().getSystemService(n.LOCATION_SERVICE).isProviderEnabled(s.GPS_PROVIDER))?e(r):i((()=>{o(!1)}))):"ios"===c.toLowerCase()&&(a=(t=plus.ios.import("CLLocationManager")).locationServicesEnabled(),plus.ios.deleteObject(t),a?e(a):i((()=>{o(!1)})))})),checkPermission:t,showAuthTipModal:(e,i=!1)=>{const o={ACCESS_FINE_LOCATION:{authorize:"android.permission.ACCESS_FINE_LOCATION",title:"定位权限说明",describe:"便于您检索附近的客户，请您确认授权，否则无法使用该功能"},CALL_PHONE:{authorize:"android.permission.CALL_PHONE",title:"拨打电话权限说明",describe:"便于您使用该功能拨打客服电话，联系客户。请您确认授权，否则无法使用该功能"},READ_EXTERNAL_STORAGE:{authorize:"android.permission.READ_EXTERNAL_STORAGE",title:"相册存储权限说明",describe:"便于您使用该功能上传您的照片、图片、视频，完善认证信息。请您确认授权，否则无法使用该功能"},CAMERA:{authorize:"android.permission.CAMERA",title:"相机权限说明",describe:"便于您使用该功能拍摄图片、录制视频，请您确认授权，否则无法使用该功能"},READ_EXTERNAL_STORAGE_CAMERA:{authorize:["android.permission.READ_EXTERNAL_STORAGE","android.permission.CAMERA"],title:"相册、相机权限说明",describe:"相册：便于您使用该功能上传您的照片、图片、视频，完善师傅认证信息。\n相机：便于您使用该功能拍摄图片、录制视频。\n请您确认授权，否则无法使用上述功能"}};return new Promise((n=>{"ios"!==plus.os.name.toLowerCase()?uni.getStorageSync(e)||!1?i?n():a(o[e].authorize,n):uni.showModal({title:o[e].title,content:o[e].describe,confirmText:"确定使用",success:s=>{if(s.confirm){if(uni.setStorageSync(e,!0),i)return void n();a(o[e].authorize,n)}else if(s.cancel){if(i)return;n(!1)}},fail:e=>{console.error(e)}}):n(!0)}))}});export{r as default};
